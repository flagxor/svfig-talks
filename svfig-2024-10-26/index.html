<!DOCTYPE html>
<style>
@font-face {
    font-family: 'APL';
    src: url('apl.ttf') format('truetype');
}
</style>
<script src="../websent/websent.js"></script><script>
FONT = "APL, courier";
USABLE = 0.9;
LINE_SPACING = 1;
BACKGROUND = '#ddccaa';
FOREGROUND = '#000000';
// <p><a href="svfig-2024-10-26/">Getting CoSy with APL and K</a> - October 26, 2024<br/>
</script><pre>

Getting CoSy with APL and K
---------------------------
     October 26, 2024

Why this talk?
--------------
âŸ APL is one of the handful of
  "big idea" languages
âŸ Realization a lot of Bob Armstrong's
  talks confuse SVFIG sometimes
  due to lack of APL + K familiarity
âŸ Desire to bridge the gap
  - Relate Forth and CoSy/APL/K ideas
âŸ To better understand status of CoSy

What is APL?
------------
âŸ Created by Ken Iverson,
  later won a Turing award for it
âŸ Started as a blackboard notation
âŸ Retroactively dubbed
  "A Programming Language"
âŸ Motivated by the desire to
  express programs at a high level
âŸ Inspiration for Matlab, R, and NumPy

What does it look like?
-----------------------
âŸ Denser than Forth!
âŸ Potentially very write only
âŸ The game of life:
  life â† {âŠƒ1 âµ âˆ¨.âˆ§ 3 4 = +/ +âŒ¿ Â¯1 0 1 âˆ˜.âŠ– Â¯1 0 1 âŒ½Â¨ âŠ‚âµ}

History
-------
âŸ Started at Harvard in 1957
âŸ Moved to IBM in 1960
  - Multi-user APL\360
âŸ Appealed to the finance, insurance, and AI communities
âŸ Filled a hole eventually subsumed by spreadsheets
  and Matlab, etc.
âŸ Used instead of BASIC in two microcomputers:
  - MCM/70 - 8008 2-8K RAM (1974)
  - VideoBrain APL/S - F8 1KB RAM (1977)
âŸ Praised by John Backus in his famous Turing lecture:
  Can programming be liberated from the von Neumann style?
  "We owe a great debt to Kenneth Iverson for showing
   us that there are programs that are neither
   word-at-a-time nor dependent on lambda expressions"

That Character Set
------------------
âŸ Intended as a substitute for
  the rich symbol set used in mathematics
âŸ 31 characters not in ASCII
âŸ Combined with Selectric over-strike
  - Character, backspace, character

â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    â”‚ Â¨  â”‚ Â¯  â”‚ <  â”‚ â‰¤  â”‚ =  â”‚ â‰¥  â”‚ >  â”‚ â‰   â”‚ âˆ¨  â”‚ âˆ§  â”‚ -  â”‚ Ã·  â”‚  BACK   â”‚
â”‚    â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 4  â”‚ 5  â”‚ 6  â”‚ 7  â”‚ 8  â”‚ 9  â”‚ 0  â”‚ +  â”‚ Ã—  â”‚  SPACE  â”‚
â”‚    â””â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”¬â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TAB   â”‚ ?  â”‚ âµ  â”‚ âˆŠ  â”‚ â´  â”‚ ~  â”‚ â†‘  â”‚ â†“  â”‚ â³  â”‚ â—‹  â”‚ *  â”‚ â†’  â”‚â”‚          â”‚
â”‚       â”‚ Q  â”‚ W  â”‚ E  â”‚ R  â”‚ T  â”‚ Y  â”‚ U  â”‚ I  â”‚ O  â”‚ P  â”‚ â†  â”‚â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¬â”€â”€â”€â”´â”¤  RETURN  â”‚
â”‚ LOCK   â”‚ âº  â”‚ âŒˆ  â”‚ âŒŠ  â”‚ _  â”‚ âˆ‡  â”‚ âˆ†  â”‚ âˆ˜  â”‚ '  â”‚ â•  â”‚ (  â”‚ )  â”‚          â”‚
â”‚        â”‚ A  â”‚ S  â”‚ D  â”‚ F  â”‚ G  â”‚ H  â”‚ J  â”‚ K  â”‚ L  â”‚ [  â”‚ ]  â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”¬â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   SHIFT   â”‚ âŠ‚  â”‚ âŠƒ  â”‚ âˆ©  â”‚ âˆª  â”‚ âŠ¥  â”‚ âŠ¤  â”‚ |  â”‚ ;  â”‚ :  â”‚ \  â”‚   SHIFT    â”‚
â”‚           â”‚ Z  â”‚ X  â”‚ C  â”‚ V  â”‚ B  â”‚ N  â”‚ M  â”‚ ,  â”‚ .  â”‚ /  â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Overstrike
----------
â—‹ + * = âŸ
âˆ© + âˆ˜ = â
/ + - = âŒ¿
âˆ† + | = â‹
Ã· + â• = âŒ¹
\ + â—‹ = â‰

Large Symbol Set
----------------
+-Ã—Ã·âŒˆâŒŠ*âŸ|!â—‹~âˆ¨âˆ§â±â²<â‰¤=â‰¥>â‰ .â‰¡â‰¢
â´,âªâ³â†‘â†“?â’â‹â‰âŒ½âŠ–âˆŠâŠ¥âŠ¤ââ•âŒ¹âŠ‚âŠƒâˆªâˆ©â·âŒ·âˆ˜
â†’â†â•â/âŒ¿\â€Â¨â£â¨#âŠ†â¥â â¤âŒ¸â¸()[];ââ‹„
:â¬âˆ‡âºâµâ¶â¹áµá‘ˆâ¡ââŒ¾â¢â«â›â§âŠ‡â®â­â¦â‡âˆââ—=

    Monadic       Dyadic
    -------       ------
+   Conjugate     Add
-   Negation      Subtract
Ã—   Signum        Multiply
Ã·   Reciprocal    Divide

    Monadic       Dyadic
    -------       ------
âŒŠ   Floor         Minimum
âŒˆ   Ceiling       Maximum
|   Magnitude     Residue
*   Exponential   Exponentiation
âŸ   Nat Log       Logarithm
â—‹   Pi times      Trigonomy
!   Factorial     Binomial
?   Roll          Deal

    Monadic       Dyadic
    -------       ------
~   Not
âˆ§                 And
âˆ¨                 Or
â²                 Nand
â±                 Nor

    Monadic       Dyadic
    -------       ------
<                 Less
â‰¤                 Not greater
=                 Equal
â‰¥                 Not less
>                 Greater
â‰                  Not equal

    Monadic       Dyadic
    -------       ------
â³   Index         Index of
â´   Size          Reshape
,   Ravel         Catenate
[]                Indexing
â†‘                 Take
â†“                 Drop

    Monadic       Dyadic
    -------       ------
â‹   Ascending
â’   Descending
/                 Compress
âŒ½   Reverse       Rotate
âŠ–   Reverse       Rotate
â‰   Transpose

    Monadic       Dyadic
    -------       ------
âˆŠ                 Membership
âŠ¥                 Decode
âŠ¤                 Encode
âŒ¹   Mat Inverse

/    Reduce (last axis)
âŒ¿    Reduce (first axis)
\    Scan (last axis)
â€    Scan (first axis)
âˆ˜.F  Outer Product
F.G  Inner Product
[]   Axis

Circlular Operator â—‹
--------------------
                       0â—‹x = sqrt(1-x^2)
Â¯1â—‹x = arcsin x        1â—‹x = sin x
Â¯2â—‹x = arccos x        2â—‹x = cos x
Â¯3â—‹x = arctan x        3â—‹x = tan x
Â¯4â—‹x = sqrt(x*2-1)     4â—‹x = sqrt(1+x^2)
Â¯5â—‹x = arcsinh x       5â—‹x = sinh x
Â¯6â—‹x = arccosh x       6â—‹x = cosh x
Â¯7â—‹x = arctanh x       7â—‹x = tanh x

Notation as a Tool of Thought 
-----------------------------
Important Characteristics of Notation:
  âŸ Ease of expressing constructs
    arising in problems
  âŸ Suggestivity
  âŸ Ability to subordinate detail
  âŸ Economy
  âŸ Amenability to formal proofs

Ease of expressing constructs
    arising in problems

      â³5
1 2 3 4 5
      +\â³5
1 3 6 10 15
    âˆ˜
   âˆ˜ âˆ˜
  âˆ˜ âˆ˜ âˆ˜
 âˆ˜ âˆ˜ âˆ˜ âˆ˜
âˆ˜ âˆ˜ âˆ˜ âˆ˜ âˆ˜

      3 4 â´ 5
5 5 5 5
5 5 5 5
5 5 5 5

Suggestivity

2Ã—3 â†â†’ 6
2*3 â†â†’ 8
+/Mâ´N â†â†’ NÃ—M
Ã—/Mâ´N â†â†’ N*M
+\Mâ´N â†â†’ NÃ—â³M
Ã—\Mâ´N â†â†’ N*â³M

   Ability to
subordinate detail

COLUMNS â† 64
ROWS â† 16
BYTES â† COLUMNS Ã— ROWS
      â³5
1 2 3 4 5
      âŒ½ 1 7 7 6
6 7 7 1
      1 2 3 , 4 5 6
1 2 3 4 5 6
      (â³5),(âŒ½â³5)
1 2 3 4 5 5 4 3 2 1

Economy
-------
âŸ Large number of ideas
  in a small vocabulary
âŸ All operators alike,
  no rules of precedence

  Amenability
to formal proofs

LEMMA
-----
    â•  â•â•â•â•â•
    â•â•  â•â•â•â•
    â•â•â•  â•â•â•
    â•â•â•â•  â•â•
    â•â•â•â•â•  â•
1 2 3 4 5 + 5 4 3 2 1
   â†â†’ 6 6 6 6 6
(â³N)+(âŒ½â³N) â†â†’ (N+1)â´N

Gauss's Formula
---------------
+/â³N
         â + is associative
         â and commutative
+/âŒ½â³N
         â (X + X) Ã· 2 â†â†’ X
((+/â³N) + (+/âŒ½â³N)) Ã· 2
         â + is associative
         â and commutative
(+/((â³N) + (âŒ½â³N))) Ã· 2
         â by Lemma
(+/((N+1)â´N)) Ã· 2
         â definition of
         â multiplication
((N+1) Ã— N) Ã· 2

Children of APL - J
-------------------
âŸ Iverson and Robert Hui (1990s)
âŸ ASCII to address concern
âŸ Focus on tacit point free style
âŸ Exploration of Focus on tacit point free style
âŸ Values and operators
  become nouns, verbs, and adverbs
âŸ Arthur Whitney's famously terse implementation

Incunabulum - An Implementation of J
https://www.jsoftware.com/ioj/iojATW.htm
 
typedef char C;typedef long I;
typedef struct a{I t,r,d[3],p[2];}*A;
#define P printf
#define R return
#define V1(f) A f(w)A w;
#define V2(f) A f(a,w)A a,w;
#define DO(n,x) {I i=0,_n=(n);for(;i<_n;++i){x;}}
I *ma(n){R(I*)malloc(n*4);}mv(d,s,n)I *d,*s;{DO(n,d[i]=s[i]);}
tr(r,d)I *d;{I z=1;DO(r,z=z*d[i]);R z;}
A ga(t,r,d)I *d;{A z=(A)ma(5+tr(r,d));z->t=t,z->r=r,mv(z->d,d,r);
 R z;}
V1(iota){I n=*w->p;A z=ga(0,1,&n);DO(n,z->p[i]=i);R z;}
V2(plus){I r=w->r,*d=w->d,n=tr(r,d);A z=ga(0,r,d);
 DO(n,z->p[i]=a->p[i]+w->p[i]);R z;}
V2(from){I r=w->r-1,*d=w->d+1,n=tr(r,d);
 A z=ga(w->t,r,d);mv(z->p,w->p+(n**a->p),n);R z;}
V1(box){A z=ga(1,0,0);*z->p=(I)w;R z;}
V2(cat){I an=tr(a->r,a->d),wn=tr(w->r,w->d),n=an+wn;
 A z=ga(w->t,1,&n);mv(z->p,a->p,an);mv(z->p+an,w->p,wn);R z;}
V2(find){}
V2(rsh){I r=a->r?*a->d:1,n=tr(r,a->p),wn=tr(w->r,w->d);
 A z=ga(w->t,r,a->p);mv(z->p,w->p,wn=n>wn?wn:n);
 if(n-=wn)mv(z->p+wn,z->p,n);R z;}
V1(sha){A z=ga(0,1,&w->r);mv(z->p,w->d,w->r);R z;}
V1(id){R w;}V1(size){A z=ga(0,0,0);*z->p=w->r?*w->d:1;R z;}
pi(i){P("%d ",i);}nl(){P("\n");}
pr(w)A w;{I r=w->r,*d=w->d,n=tr(r,d);DO(r,pi(d[i]));nl();
 if(w->t)DO(n,P("< ");pr(w->p[i]))else DO(n,pi(w->p[i]));nl();}
 
C vt[]="+{~<#,";
A(*vd[])()={0,plus,from,find,0,rsh,cat},
 (*vm[])()={0,id,size,iota,box,sha,0};
I st[26]; qp(a){R  a>='a'&&a<='z';}qv(a){R a<'a';}
A ex(e)I *e;{I a=*e;
 if(qp(a)){if(e[1]=='=')R st[a-'a']=ex(e+2);a= st[ a-'a'];}
 R qv(a)?(*vm[a])(ex(e+1)):e[1]?(*vd[e[1]])(a,ex(e+2)):(A)a;}
noun(c){A z;if(c<'0'||c>'9')R 0;z=ga(0,0,0);*z->p=c-'0';R z;}
verb(c){I i=0;for(;vt[i];)if(vt[i++]==c)R i;R 0;}
I *wd(s)C *s;{I a,n=strlen(s),*e=ma(n+1);C c;
 DO(n,e[i]=(a=noun(c=s[i]))?a:(a=verb(c))?a:c);e[n]=0;R e;}
 
main(){C s[99];while(gets(s))pr(ex(wd(s)));}

APL  J     APL  J     APL  J     APL  J
---  -     ---  -     ---  -     ---  -
+    +     ~    -.    â³    i.    âˆŠ    e.
-    -     âˆ§    *.    â´    $     âŠ¥    #.
Ã—    *     âˆ¨    +.    ,    ,     âŠ¤    #:
Ã·    %     â²    *:    []   {     âŒ¹    %.
âŒŠ    <.    â±    +:    â†‘    {.    /    /
âŒˆ    >.    <    &lt;     â†“    }.    âŒ¿    ??
|    |     â‰¤    &lt;:    â‹    /:    \    \
*    ^     =    =     â’    \:    â€    ??
âŸ    ^.    â‰¥    >:    âŒ½    |.    âˆ˜.F  F/
â—‹    o.    >    >     âŠ–    ??    F.G  F/ . G
!    !     â‰     ~:    â‰    |:
?    ?

Children of APL - K
-------------------
âŸ Arthur Whitney (1993+)
âŸ ASCII, but focused on single characters
âŸ Only the most important operators
âŸ Kx, multiple incompatible generations
âŸ Borrow from Scheme: lists of lists

APL     K3        APL     K3       APL      K3
---     --        ---     --       ---      --
â‰ +     +         ~ ='    ~        ?        _draw
-       -         x â³     @        âŒˆ        _ceiling
âŠƒ Ã—     *         x â£     ?        âŒŠ        _floor
Ã·       %         âŒŠ x     _        1â—‹       _sin
| > âˆ¨   |         x ,     ,        2â—‹       _cos
â³ < âˆ§   &         â‰¢ â´     #        3â—‹       _tan
â´ *     ^         â• â     $        âŸ        _log
â³ âŒ½     !         .       .        *        _exp
â‹ <     <         / â     /        ....
â’ >     >         \       \
x =     =         Â¨       '
x       /:        []      []
x       \:

Type   Rank  Dimensions  Raveled Data
----   ----  ----------  ------------
Num    3     2  3  4     0 1 2 3 4 5...
 
Boxing? Depth?

Array Models
------------
âŸ APL and others supports nested arrays
  - APL1 had a "flat box model"
  - APL2 introduced the "nested box model"
âŸ J continues using multidimensional arrays
âŸ K switches to nested 1D arrays

CoSy
----
âŸ Bob Armstrong (20??)
âŸ Translate K's idioms to Forth
âŸ Vocabulary built on top of Reva Forth
âŸ Typed 1D arrays
  - Integer / Character / Float / Box
  - Looks like wants to support more?
âŸ Vocabulary inspired by mix of K + APL names

Reva Forth
----------
âŸ Bob Armstrong (20??)
âŸ Case Sensitive
âŸ { ... } allows inline :noname
âŸ X86 Forth
âŸ GUI seems to be unavailable online?

i( 1 2 3 4 )i          -- list of integer
f( 1 2 3 4)f           -- list of float
`( list of strings )`  -- list of strings

123 _i        -- list of one integer
123.4 _f      -- list of one float
" hi" _str    -- list of one string

+i        -- dyadic add
-i        -- dyadic subtract
*i        -- dyadic multiply
/i        -- dyadic divide
modi      -- dyadic modulus
\/ mini   -- dyadic minimum
/\ maxi   -- dyadic maximum
ori       -- dyadic bitwise or
andi      -- dyadic bitwise and
=i        -- dyadic equal
<>i       -- dyadic not equal
<i        -- dyadic less
>i        -- dyadic greater
0<>i      -- monadic not equal
0<i       -- monadic less than zero
0>i       -- monadic greater than zero
I>M       -- Iverson to Moore logic 1 vs -1
M>I       -- Moore to Iverson logic 1 vs -1
absi      -- monadic absolute value
-0+i      -- monadic sign

lst       -- print a list
,I        -- catenate (integers)
,L        -- catenate as lists (like lisp cons)
'm        -- monadic each
'L        -- dyadic each left
'R        -- dyadic each left
each      -- dyadic each
^+        -- dyadic add (seems to assume int?)
^=        -- dyadic equal (seems to assume int?)
./        -- dyadic reduce (like APL /)
.\        -- dyadic scan (like APL \)
+/        -- like APL +/
+\        -- like APL +\
':        -- apply between pairs

reverse   -- monadic flip
rotate    -- flip at nth position
sublist   -- extract subrange of list
memb      -- check for membership
where     -- locate an item in a list
flip      -- transpose

  DEMO +
QUESTIONSâ“
    ğŸ™
 Thank you!
